# ripga4d.jl : reference implementation of
# Projective Geometric Algebra for 4D
#
# This is an extension of pga3d.cpp, bivector.net's C++
# reference implementation of projective geometric algebra
# available at https://bivector.net/tools.html
#
using Printf

# define multivector basis names
# 0 denotes projective dimension (e.g., e0 * e0 = 0)
basis = [# iField
 "1"   #  1 scalar
 "e0"  #  2 grade 1 vectors
 "e1"  #  3
 "e2"  #  4
 "e3"  #  5
 "e4"  #  6
 "e01"  #  7 grade 2 vectors (bivectors)
 "e02"  #  8
 "e03"  #  9
 "e04"  # 10
 "e12"  # 11
 "e13"  # 12
 "e14"  # 13
 "e23"  # 14
 "e24"  # 15
 "e34"  # 16
 "e012"  # 17 grade 3 vectors (trivectors)
 "e013"  # 18
 "e014"  # 19
 "e023"  # 20
 "e024"  # 21
 "e034"  # 22
 "e123"  # 23
 "e124"  # 24
 "e134"  # 25
 "e234"  # 26
 "e0123"  # 27
 "e0124"  # 28
 "e0134"  # 29
 "e0234"  # 30
 "e1234"  # 31
 "e01234"] # 32 pseudoscalar

# define basis multivectors
nField = 2^5
e0 =    zeros(Float32, nField); e0[2] = 1
e1 =    zeros(Float32, nField); e1[3] = 1
e2 =    zeros(Float32, nField); e2[4] = 1
e3 =    zeros(Float32, nField); e3[5] = 1
e4 =    zeros(Float32, nField); e4[6] = 1
e01 =   zeros(Float32, nField); e01[7] = 1
e02 =   zeros(Float32, nField); e02[8] = 1
e03 =   zeros(Float32, nField); e03[9] = 1
e04 =   zeros(Float32, nField); e04[10] = 1
e12 = zeros(Float32, nField); e12[11] = 1
e13 = zeros(Float32, nField); e13[12] = 1
e14 = zeros(Float32, nField); e14[13] = 1
e23 = zeros(Float32, nField); e23[14] = 1
e24 = zeros(Float32, nField); e24[15] = 1
e34 = zeros(Float32, nField); e34[16] = 1
e012 = zeros(Float32, nField); e012[17] = 1
e013 = zeros(Float32, nField); e013[18] = 1
e014 = zeros(Float32, nField); e014[19] = 1
e023 = zeros(Float32, nField); e023[20] = 1
e024 = zeros(Float32, nField); e024[21] = 1
e034 = zeros(Float32, nField); e034[22] = 1
e123 = zeros(Float32, nField); e123[23] = 1
e124 = zeros(Float32, nField); e124[24] = 1
e134 = zeros(Float32, nField); e134[25] = 1
e234 = zeros(Float32, nField); e234[26] = 1
e0123 = zeros(Float32, nField); e0123[27] = 1
e0124 = zeros(Float32, nField); e0124[28] = 1
e0134 = zeros(Float32, nField); e0134[29] = 1
e0234 = zeros(Float32, nField); e0234[30] = 1
e1234 = zeros(Float32, nField); e1234[31] = 1
e01234 = zeros(Float32, nField); e01234[32] = 1

# geometric product
function Base.:*(a::Vector{Float32},b::Vector{Float32})::Vector{Float32}
 res = similar(a)
 res[1]=(a[1] *b[1] +a[3] *b[3] # 1
     +a[4] *b[4] +a[5] *b[5]
     +a[6] *b[6] -a[11]*b[11]
     -a[12]*b[12]-a[13]*b[13]
     -a[14]*b[14]-a[15]*b[15]
     -a[16]*b[16]-a[23]*b[23]
     -a[24]*b[24]-a[25]*b[25]
     -a[26]*b[26]+a[31]*b[31])
 res[2]=(a[2] *b[1] +a[1] *b[2] # e0
     +a[7] *b[3] -a[3] *b[7]
     +a[8] *b[4] -a[4] *b[8]
     +a[9] *b[5] -a[5] *b[9]
     +a[10]*b[6] -a[6] *b[10]
     -a[17]*b[11]-a[11]*b[17]
     -a[18]*b[12]-a[12]*b[18]
     -a[19]*b[13]-a[13]*b[19]
     -a[20]*b[14]-a[14]*b[20]
     -a[21]*b[15]-a[15]*b[21]
     -a[22]*b[16]-a[16]*b[22]
     -a[27]*b[23]+a[23]*b[27]
     -a[28]*b[24]+a[24]*b[28]
     -a[29]*b[25]+a[25]*b[29]
     -a[30]*b[26]+a[26]*b[30]
     +a[32]*b[31]+a[31]*b[32])
 res[3]=(a[3] *b[1] +a[1] *b[3] # e1
     +a[11]*b[4] -a[4] *b[11]
     +a[12]*b[5] -a[5] *b[12]
     +a[13]*b[6] -a[6] *b[13]
     -a[23]*b[14]-a[14]*b[23]
     -a[24]*b[15]-a[15]*b[24]
     -a[25]*b[16]-a[16]*b[25]
     -a[31]*b[26]+a[26]*b[31])
 res[4]=(a[4]*b[1]  +a[1] *b[4] # e2
     -a[11]*b[3] +a[3] *b[11]
     +a[14]*b[5] -a[5] *b[14]
     +a[15]*b[6] -a[6] *b[15]
     +a[23]*b[12]+a[12]*b[23]
     +a[24]*b[13]+a[13]*b[24]
     -a[26]*b[16]-a[16]*b[26]
     +a[31]*b[25]-a[25]*b[31])
 res[5]=(a[5] *b[1] +a[1] *b[5] # e3
     -a[12]*b[3] +a[3] *b[12]
     -a[14]*b[4] +a[4] *b[14]
     +a[16]*b[6] -a[6] *b[16]
     -a[23]*b[11]-a[11]*b[23]
     +a[25]*b[13]+a[13]*b[25]
     +a[26]*b[15]+a[15]*b[26]
     -a[31]*b[24]+a[24]*b[31])
 res[6]=(a[6] *b[1] +a[1] *b[6] # e4
     -a[13]*b[3] +a[3] *b[13]
     -a[15]*b[4] +a[4] *b[15]
     -a[16]*b[5] +a[5] *b[16]
     -a[24]*b[11]-a[11]*b[24]
     -a[25]*b[12]-a[12]*b[25]
     -a[26]*b[14]-a[14]*b[26]
     +a[31]*b[23]-a[23]*b[31])
 res[7]=(a[7] *b[1] +a[1] *b[7] # e01
     -a[3] *b[2] +a[2] *b[3]
     +a[17]*b[4] +a[4] *b[17]
     +a[18]*b[5] +a[5] *b[18]
     +a[19]*b[6] +a[6] *b[19]
     +a[11]*b[8] -a[8] *b[11]
     +a[12]*b[9] -a[9] *b[12]
     +a[13]*b[10]-a[10]*b[13]
     -a[27]*b[14]-a[14]*b[27]
     -a[28]*b[15]-a[15]*b[28]
     -a[29]*b[16]-a[16]*b[29]
     +a[23]*b[20]-a[20]*b[23]
     +a[24]*b[21]-a[21]*b[24]
     +a[25]*b[22]-a[22]*b[25]
     -a[32]*b[26]-a[26]*b[32]
     -a[31]*b[30]+a[30]*b[31])
 res[8]=(a[8] *b[1] +a[1] *b[8] # e02
     -a[4] *b[2] +a[2] *b[4]
     -a[17]*b[3] -a[3] *b[17]
     +a[20]*b[5] +a[5] *b[20]
     +a[21]*b[6] +a[6] *b[21]
     -a[11]*b[7] +a[7] *b[11]
     +a[14]*b[9] -a[9] *b[14]
     +a[15]*b[10]-a[10]*b[15]
     +a[27]*b[12]+a[12]*b[27]
     +a[28]*b[13]+a[13]*b[28]
     -a[30]*b[16]-a[16]*b[30]
     -a[23]*b[18]+a[18]*b[23]
     -a[24]*b[19]+a[19]*b[24]
     +a[26]*b[22]-a[22]*b[26]
     +a[32]*b[25]+a[25]*b[32]
     +a[31]*b[29]-a[29]*b[31])
 res[9]=(a[9] *b[1] +a[1] *b[9] # e03
     -a[5] *b[2] +a[2] *b[5]
     -a[18]*b[3] -a[3] *b[18]
     -a[20]*b[4] -a[4] *b[20]
     +a[22]*b[6] +a[6] *b[22]
     -a[12]*b[7] +a[7] *b[12]
     -a[14]*b[8] +a[8] *b[14]
     +a[16]*b[10]-a[10]*b[16]
     -a[27]*b[11]-a[11]*b[27]
     +a[29]*b[13]+a[13]*b[29]
     +a[30]*b[15]+a[15]*b[30]
     +a[23]*b[17]-a[17]*b[23]
     -a[25]*b[19]+a[19]*b[25]
     -a[26]*b[21]+a[21]*b[26]
     -a[32]*b[24]-a[24]*b[32]
     -a[31]*b[28]+a[28]*b[31])
 res[10]=(a[10]*b[1] +a[1] *b[10] # e04
      -a[6] *b[2] +a[2] *b[6]
      -a[19]*b[3] -a[3] *b[19]
      -a[21]*b[4] -a[4] *b[21]
      -a[22]*b[5] -a[5] *b[22]
      -a[13]*b[7] +a[7] *b[13]
      -a[15]*b[8] +a[8] *b[15]
      -a[16]*b[9] +a[9] *b[16]
      -a[28]*b[11]-a[11]*b[28]
      -a[29]*b[12]-a[12]*b[29]
      -a[30]*b[14]-a[14]*b[30]
      +a[24]*b[17]-a[17]*b[24]
      +a[25]*b[18]-a[18]*b[25]
      +a[26]*b[20]-a[20]*b[26]
      +a[32]*b[23]+a[23]*b[32]
      +a[31]*b[27]-a[27]*b[31])
 res[11]=(a[11]*b[1] +a[1] *b[11] # e12
      -a[4] *b[3] +a[3] *b[4]
      +a[23]*b[5] +a[5] *b[23]
      +a[24]*b[6] +a[6] *b[24]
      +a[14]*b[12]-a[12]*b[14]
      +a[15]*b[13]-a[13]*b[15]
      -a[31]*b[16]-a[16]*b[31]
      +a[26]*b[25]-a[25]*b[26])
 res[12]=(a[12]*b[1] +a[1] *b[12] # e13
      -a[5] *b[3] +a[3] *b[5]
      -a[23]*b[4] -a[4] *b[23]
      +a[25]*b[6] +a[6] *b[25]
      -a[14]*b[11]+a[11]*b[14]
      +a[16]*b[13]-a[13]*b[16]
      +a[31]*b[15]+a[15]*b[31]
      -a[26]*b[24]+a[24]*b[26])
 res[13]=(a[13]*b[1] +a[1] *b[13] # e14
      -a[6] *b[3] +a[3] *b[6]
      -a[24]*b[4] -a[4] *b[24]
      -a[25]*b[5] -a[5] *b[25]
      -a[15]*b[11]+a[11]*b[15]
      -a[16]*b[12]+a[12]*b[16]
      -a[31]*b[14]-a[14]*b[31]
      +a[26]*b[23]-a[23]*b[26])
 res[14]=(a[14]*b[1] +a[1] *b[14] # e23
      -a[5] *b[4] +a[4] *b[5]
      +a[23]*b[3] +a[3] *b[23]
      +a[26]*b[6] +a[6] *b[26]
      +a[12]*b[11]-a[11]*b[12]
      -a[31]*b[13]-a[13]*b[31]
      +a[16]*b[15]-a[15]*b[16]
      +a[25]*b[24]-a[24]*b[25])
 res[15]=(a[15]*b[1] +a[1] *b[15] # e24
      -a[6] *b[4] +a[4] *b[6]
      +a[24]*b[3] +a[3] *b[24]
      -a[26]*b[5] -a[5] *b[26]
      +a[13]*b[11]-a[11]*b[13]
      -a[16]*b[14]+a[14]*b[16]
      +a[31]*b[12]+a[12]*b[31]
      -a[25]*b[23]+a[23]*b[25])
 res[16]=(a[16]*b[1] +a[1] *b[16] # e34
      -a[6] *b[5] +a[5] *b[6]
      +a[25]*b[3] +a[3] *b[25]
      +a[26]*b[4] +a[4] *b[26]
      +a[13]*b[12]-a[12]*b[13]
      +a[15]*b[14]-a[14]*b[15]
      -a[31]*b[11]-a[11]*b[31]
      +a[24]*b[23]-a[23]*b[24])
 res[17]=(a[17]*b[1] +a[1] *b[17] # e012
      +a[11]*b[2] +a[2] *b[11]
      -a[8] *b[3] -a[3] *b[8]
      +a[7] *b[4] +a[4] *b[7]
      +a[27]*b[5] -a[5] *b[27]
      +a[28]*b[6] -a[6] *b[28]
      -a[23]*b[9] +a[9] *b[23]
      -a[24]*b[10]+a[10]*b[24]
      +a[20]*b[12]-a[12]*b[20]
      +a[21]*b[13]-a[13]*b[21]
      -a[32]*b[16]-a[16]*b[32]
      -a[18]*b[14]+a[14]*b[18]
      -a[19]*b[15]+a[15]*b[19]
      -a[31]*b[22]-a[22]*b[31]
      +a[30]*b[25]+a[25]*b[30]
      -a[29]*b[26]-a[26]*b[29])
 res[18]=(a[18]*b[1] +a[1] *b[18] # e013
      +a[12]*b[2] +a[2] *b[12]
      -a[9] *b[3] -a[3] *b[9]
      +a[7] *b[5] +a[5] *b[7]
      -a[27]*b[4] +a[4] *b[27]
      +a[29]*b[6] -a[6] *b[29]
      +a[23]*b[8] -a[8] *b[23]
      -a[25]*b[10]+a[10]*b[25]
      -a[20]*b[11]+a[11]*b[20]
      +a[22]*b[13]-a[13]*b[22]
      +a[17]*b[14]-a[14]*b[17]
      -a[19]*b[16]+a[16]*b[19]
      +a[32]*b[15]+a[15]*b[32]
      +a[31]*b[21]+a[21]*b[31]
      -a[30]*b[24]-a[24]*b[30]
      +a[28]*b[26]+a[26]*b[28])
 res[19]=(a[19]*b[1] +a[1] *b[19] # e014
      +a[13]*b[2] +a[2] *b[13]
      -a[10]*b[3] -a[3] *b[10]
      -a[28]*b[4] +a[4] *b[28]
      -a[29]*b[5] +a[5] *b[29]
      +a[7] *b[6] +a[6] *b[7]
      +a[24]*b[8] -a[8] *b[24]
      +a[25]*b[9] -a[9] *b[25]
      -a[21]*b[11]+a[11]*b[21]
      -a[22]*b[12]+a[12]*b[22]
      +a[17]*b[15]-a[15]*b[17]
      +a[18]*b[16]-a[16]*b[18]
      -a[32]*b[14]-a[14]*b[32]
      -a[31]*b[20]-a[20]*b[31]
      +a[30]*b[23]+a[23]*b[30]
      -a[27]*b[26]-a[26]*b[27])
 res[20]=(a[20]*b[1] +a[1] *b[20] # e023
      +a[14]*b[2] +a[2] *b[14]
      +a[27]*b[3] -a[3] *b[27]
      +a[30]*b[6] -a[6] *b[30]
      -a[9] *b[4] -a[4] *b[9]
      +a[8] *b[5] +a[5] *b[8]
      -a[23]*b[7] +a[7] *b[23]
      -a[26]*b[10]+a[10]*b[26]
      +a[18]*b[11]-a[11]*b[18]
      -a[17]*b[12]+a[12]*b[17]
      +a[22]*b[15]-a[15]*b[22]
      -a[21]*b[16]+a[16]*b[21]
      -a[32]*b[13]-a[13]*b[32]
      -a[31]*b[19]-a[19]*b[31]
      +a[29]*b[24]+a[24]*b[29]
      -a[28]*b[25]-a[25]*b[28])
 res[21]=(a[21]*b[1] +a[1] *b[21] # e024
      +a[15]*b[2] +a[2] *b[15]
      +a[28]*b[3] -a[3] *b[28]
      -a[30]*b[5] +a[5] *b[30]
      -a[10]*b[4] -a[4] *b[10]
      +a[8] *b[6] +a[6] *b[8]
      -a[24]*b[7] +a[7] *b[24]
      +a[26]*b[9] -a[9] *b[26]
      +a[19]*b[11]-a[11]*b[19]
      -a[17]*b[13]+a[13]*b[17]
      -a[22]*b[14]+a[14]*b[22]
      +a[20]*b[16]-a[16]*b[20]
      +a[32]*b[12]+a[12]*b[32]
      +a[31]*b[18]+a[18]*b[31]
      -a[29]*b[23]-a[23]*b[29]
      +a[27]*b[25]+a[25]*b[27])
 res[22]=(a[22]*b[1] +a[1] *b[22] # e034
      +a[16]*b[2] +a[2] *b[16]
      +a[29]*b[3] -a[3] *b[29]
      +a[30]*b[4] -a[4] *b[30]
      -a[10]*b[5] -a[5] *b[10]
      +a[9] *b[6] +a[6] *b[9]
      -a[25]*b[7] +a[7] *b[25]
      -a[26]*b[8] +a[8] *b[26]
      +a[19]*b[12]-a[12]*b[19]
      -a[18]*b[13]+a[13]*b[18]
      +a[21]*b[14]-a[14]*b[21]
      -a[20]*b[15]+a[15]*b[20]
      -a[32]*b[11]-a[11]*b[32]
      -a[31]*b[17]-a[17]*b[31]
      +a[28]*b[23]+a[23]*b[28]
      -a[27]*b[24]-a[24]*b[27])
 res[23]=(a[23]*b[1] +a[1] *b[23] # e123
      +a[14]*b[3] +a[3] *b[14]
      +a[31]*b[6] -a[6] *b[31]
      -a[12]*b[4] -a[4] *b[12]
      +a[11]*b[5] +a[5] *b[11]
      -a[26]*b[13]+a[13]*b[26]
      +a[25]*b[15]-a[15]*b[25]
      -a[24]*b[16]+a[16]*b[24])
 res[24]=(a[24]*b[1] +a[1] *b[24] # e124
      +a[15]*b[3] +a[3] *b[15]
      -a[31]*b[5] +a[5] *b[31]
      -a[13]*b[4] -a[4] *b[13]
      +a[11]*b[6] +a[6] *b[11]
      +a[26]*b[12]-a[12]*b[26]
      -a[25]*b[14]+a[14]*b[25]
      +a[23]*b[16]-a[16]*b[23])
 res[25]=(a[25]*b[1] +a[1] *b[25] # e134
      +a[16]*b[3] +a[3] *b[16]
      +a[31]*b[4] -a[4] *b[31]
      -a[13]*b[5] -a[5] *b[13]
      +a[12]*b[6] +a[6] *b[12]
      -a[26]*b[11]+a[11]*b[26]
      +a[24]*b[14]-a[14]*b[24]
      -a[23]*b[15]+a[15]*b[23])
 res[26]=(a[26]*b[1] +a[1] *b[26] # e234
      -a[31]*b[3] +a[3] *b[31]
      +a[16]*b[4] +a[4] *b[16]
      -a[15]*b[5] -a[5] *b[15]
      +a[14]*b[6] +a[6] *b[14]
      +a[25]*b[11]-a[11]*b[25]
      -a[24]*b[12]+a[12]*b[24]
      +a[23]*b[13]-a[13]*b[23])
 res[27]=(a[27]*b[1] +a[1] *b[27] # e0123
      -a[23]*b[2] +a[2] *b[23]
      +a[20]*b[3] -a[3] *b[20]
      -a[18]*b[4] +a[4] *b[18]
      +a[17]*b[5] -a[5] *b[17]
      +a[32]*b[6] +a[6] *b[32]
      +a[14]*b[7] +a[7] *b[14]
      -a[12]*b[8] -a[8] *b[12]
      +a[11]*b[9] +a[9] *b[11]
      +a[31]*b[10]-a[10]*b[31]
      -a[30]*b[13]+a[13]*b[30]
      +a[29]*b[15]-a[15]*b[29]
      -a[28]*b[16]+a[16]*b[28]
      +a[26]*b[19]+a[19]*b[26]
      -a[25]*b[21]-a[21]*b[25]
      +a[24]*b[22]+a[22]*b[24])
 res[28]=(a[28]*b[1] +a[1] *b[28] # e0124
      -a[24]*b[2] +a[2] *b[24]
      +a[21]*b[3] -a[3] *b[21]
      -a[19]*b[4] +a[4] *b[19]
      -a[32]*b[5] -a[5] *b[32]
      +a[17]*b[6] -a[6] *b[17]
      +a[15]*b[7] +a[7] *b[15]
      -a[13]*b[8] -a[8] *b[13]
      -a[31]*b[9] +a[9] *b[31]
      +a[11]*b[10]+a[10]*b[11]
      +a[30]*b[12]-a[12]*b[30]
      -a[29]*b[14]+a[14]*b[29]
      +a[27]*b[16]-a[16]*b[27]
      -a[26]*b[18]-a[18]*b[26]
      +a[25]*b[20]+a[20]*b[25]
      -a[23]*b[22]-a[22]*b[23])
 res[29]=(a[29]*b[1] +a[1] *b[29] # e0134
      -a[25]*b[2] +a[2] *b[25]
      +a[22]*b[3] -a[3] *b[22]
      +a[32]*b[4] +a[4] *b[32]
      -a[19]*b[5] +a[5] *b[19]
      +a[18]*b[6] -a[6] *b[18]
      +a[16]*b[7] +a[7] *b[16]
      +a[31]*b[8] -a[8] *b[31]
      -a[13]*b[9] -a[9] *b[13]
      +a[12]*b[10]+a[10]*b[12]
      -a[30]*b[11]+a[11]*b[30]
      +a[28]*b[14]-a[14]*b[28]
      -a[27]*b[15]+a[15]*b[27]
      +a[26]*b[17]+a[17]*b[26]
      -a[24]*b[20]-a[20]*b[24]
      +a[23]*b[21]+a[21]*b[23])
 res[30]=(a[30]*b[1] +a[1] *b[30] # e0234
      -a[26]*b[2] +a[2] *b[26]
      -a[32]*b[3] -a[3] *b[32]
      +a[22]*b[4] -a[4] *b[22]
      -a[21]*b[5] +a[5] *b[21]
      +a[20]*b[6] -a[6] *b[20]
      -a[31]*b[7] +a[7] *b[31]
      +a[16]*b[8] +a[8] *b[16]
      -a[15]*b[9] -a[9] *b[15]
      +a[14]*b[10]+a[10]*b[14]
      +a[29]*b[11]-a[11]*b[29]
      -a[28]*b[12]+a[12]*b[28]
      +a[27]*b[13]-a[13]*b[27]
      -a[25]*b[17]-a[17]*b[25]
      +a[24]*b[18]+a[18]*b[24]
      -a[23]*b[19]-a[19]*b[23])
 res[31]=(a[31]*b[1] +a[1] *b[31] # e1234
      -a[26]*b[3] +a[3]*b[26]
      +a[25]*b[4] -a[4]*b[25]
      -a[24]*b[5] +a[5]*b[24]
      +a[23]*b[6] -a[6]*b[23]
      +a[16]*b[11]+a[11]*b[16]
      -a[15]*b[12]-a[12]*b[15]
      +a[14]*b[13]+a[13]*b[14])
 res[32]=(a[32]*b[1] +a[1] *b[32] # e01234
      +a[31]*b[2] +a[2] *b[31]
      -a[30]*b[3] -a[3] *b[30]
      +a[29]*b[4] +a[4] *b[29]
      -a[28]*b[5] -a[5] *b[28]
      +a[27]*b[6] +a[6] *b[27]
      +a[26]*b[7] +a[7] *b[26]
      -a[25]*b[8] -a[8] *b[25]
      +a[24]*b[9] +a[9] *b[24]
      -a[23]*b[10]-a[10]*b[23]
      +a[22]*b[11]+a[11]*b[22]
      -a[21]*b[12]-a[12]*b[21]
      +a[20]*b[13]+a[13]*b[20]
      +a[19]*b[14]+a[14]*b[19]
      -a[18]*b[15]-a[15]*b[18]
      +a[17]*b[16]+a[16]*b[17])
 return res
end # geometric product (*)

# regressive product: vee operator (&, \vee)
function Base.:&(a::Vector{Float32},b::Vector{Float32})::Vector{Float32}
 res = similar(a)
 
 res[1] =(a[32]*b[1] +a[1] *b[32] # 1
   +a[31]*b[2] +a[2] *b[31]
   -a[30]*b[3] -a[3] *b[30]
   +a[29]*b[4] +a[4] *b[29]
   -a[28]*b[5] -a[5] *b[28]
   +a[27]*b[6] +a[6] *b[27]
   +a[26]*b[7] +a[7] *b[26]
   -a[25]*b[8] -a[8] *b[25]
   +a[24]*b[9] +a[9] *b[24]
   -a[23]*b[10]-a[10]*b[23]
   +a[22]*b[11]+a[11]*b[22]
   -a[21]*b[12]-a[12]*b[21]
   +a[20]*b[13]+a[13]*b[20]
   +a[19]*b[14]+a[14]*b[19]
   -a[18]*b[15]-a[15]*b[18]
   +a[17]*b[16]+a[16]*b[17])
   
 res[2] =(a[32]*b[2] +a[2] *b[32] # e0
   +a[30]*b[7] -a[7] *b[30]
   -a[29]*b[8] +a[8] *b[29]
   +a[28]*b[9] -a[9] *b[28]
   -a[27]*b[10]+a[10]*b[27]
   +a[22]*b[17]+a[17]*b[22]
   -a[21]*b[18]-a[18]*b[21]
   +a[20]*b[19]+a[19]*b[20])
 res[3] =(a[32]*b[3] +a[3] *b[32] # e1
   +a[31]*b[7] -a[7] *b[31]
   -a[29]*b[11]+a[11]*b[29]
   +a[28]*b[12]-a[12]*b[28]
   -a[27]*b[13]+a[13]*b[27]
   +a[25]*b[17]+a[17]*b[25]
   -a[24]*b[18]-a[18]*b[24]
   +a[23]*b[19]+a[19]*b[23])
 res[4] =(a[32]*b[4] +a[4] *b[32] # e2
   +a[31]*b[8] -a[8] *b[31]
   -a[30]*b[11]+a[11]*b[30]
   +a[28]*b[14]-a[14]*b[28]
   -a[27]*b[15]+a[15]*b[27]
   +a[26]*b[17]+a[17]*b[26]
   -a[24]*b[20]-a[20]*b[24]
   +a[23]*b[21]+a[21]*b[23])
 res[5] =(a[32]*b[5] +a[5] *b[32] # e3
   +a[31]*b[9] -a[9] *b[31]
   -a[30]*b[12]+a[12]*b[30]
   +a[29]*b[14]-a[14]*b[29]
   -a[27]*b[16]+a[16]*b[27]
   +a[26]*b[18]+a[18]*b[26]
   -a[25]*b[20]-a[20]*b[25]
   +a[23]*b[22]+a[22]*b[23])
 res[6] =(a[32]*b[6] +a[6] *b[32] # e4
   +a[31]*b[10]-a[10]*b[31]
   -a[30]*b[13]+a[13]*b[30]
   +a[29]*b[15]-a[15]*b[29]
   -a[28]*b[16]+a[16]*b[28]
   +a[26]*b[19]+a[19]*b[26]
   -a[25]*b[21]-a[21]*b[25]
   +a[24]*b[22]+a[22]*b[24])
 
 res[7] =(a[32]*b[7] +a[7] *b[32] # e01
   +a[29]*b[17]+a[17]*b[29]
   -a[28]*b[18]-a[18]*b[28]
   +a[27]*b[19]+a[19]*b[27])
 res[8] =(a[32]*b[8] +a[8] *b[32] # e02
   +a[30]*b[17]+a[17]*b[30]
   -a[28]*b[20]-a[20]*b[28]
   +a[27]*b[21]+a[21]*b[27])
 res[9] =(a[32]*b[9] +a[9] *b[32] # e03
   +a[30]*b[18]+a[18]*b[30]
   -a[29]*b[20]-a[20]*b[29]
   +a[27]*b[22]+a[22]*b[27])
 res[10]=(a[32]*b[10]+a[10]*b[32] # e04
   +a[30]*b[19]+a[19]*b[30]
   -a[29]*b[21]-a[21]*b[29]
   +a[28]*b[22]+a[22]*b[28])
 res[11]=(a[32]*b[11]+a[11]*b[32] # e12
   +a[31]*b[17]+a[17]*b[31]
   -a[28]*b[23]-a[23]*b[28]
   +a[27]*b[24]+a[24]*b[27])
 res[12]=(a[32]*b[12]+a[12]*b[32] # e13
   +a[31]*b[18]+a[18]*b[31]
   -a[29]*b[23]-a[23]*b[29]
   +a[27]*b[25]+a[25]*b[27])
 res[13]=(a[32]*b[13]+a[13]*b[32] # e14
   +a[31]*b[19]+a[19]*b[31]
   -a[29]*b[24]-a[24]*b[29]
   +a[28]*b[25]+a[25]*b[28])
 res[14]=(a[32]*b[14]+a[14]*b[32] # e23
   +a[31]*b[20]+a[20]*b[31]
   -a[30]*b[23]-a[23]*b[30]
   +a[27]*b[26]+a[26]*b[27])
 res[15]=(a[32]*b[15]+a[15]*b[32] # e24
   +a[31]*b[21]+a[21]*b[31]
   -a[30]*b[24]-a[24]*b[30]
   +a[28]*b[26]+a[26]*b[28])
 res[16]=(a[32]*b[16]+a[16]*b[32] # e34
   +a[31]*b[22]+a[22]*b[31]
   -a[30]*b[25]-a[25]*b[30]
   +a[29]*b[26]+a[26]*b[29])
 
 res[17]=(a[32]*b[17]+a[17]*b[32] # e012
   +a[28]*b[27]-a[27]*b[28])
 res[18]=(a[32]*b[18]+a[18]*b[32] # e013
   +a[29]*b[27]-a[27]*b[29])
 res[19]=(a[32]*b[19]+a[19]*b[32] # e014
   +a[29]*b[28]-a[28]*b[29])
 res[20]=(a[32]*b[20]+a[20]*b[32] # e023
   +a[30]*b[27]-a[27]*b[30])
 res[21]=(a[32]*b[21]+a[21]*b[32] # e024
   +a[30]*b[28]-a[28]*b[30])
 res[22]=(a[32]*b[22]+a[22]*b[32] # e034
   +a[30]*b[29]-a[29]*b[30])
 res[23]=(a[32]*b[23]+a[23]*b[32] # e123
   +a[31]*b[27]-a[27]*b[31])
 res[24]=(a[32]*b[24]+a[24]*b[32] # e124`
   +a[31]*b[28]-a[28]*b[31])
 res[25]=(a[32]*b[25]+a[25]*b[32] # e134
   +a[31]*b[29]-a[29]*b[31])
 res[26]=(a[32]*b[26]+a[26]*b[32] # e234
   +a[31]*b[30]-a[30]*b[31])
 
 res[27]=a[32]*b[27]+a[27]*b[32] # e0123
 res[28]=a[32]*b[28]+a[28]*b[32] # e0124
 res[29]=a[32]*b[29]+a[29]*b[32] # e0134
 res[30]=a[32]*b[30]+a[30]*b[32] # e0234
 res[31]=a[32]*b[31]+a[31]*b[32] # e1234
 
 res[32]=a[32]*b[32] # e01234
 return res
end # regressive product; vee operator (&, \vee)

# inner product (|)
function Base.:|(a::Vector{Float32},b::Vector{Float32})::Vector{Float32}
 res = similar(a)
 res[1] =(a[1] *b[1] +a[3] *b[3] # 1
   +a[4] *b[4] +a[5] *b[5]
   +a[6] *b[6] -a[11]*b[11]
   -a[12]*b[12]-a[13]*b[13]
   -a[14]*b[14]-a[15]*b[15]
   -a[16]*b[16]-a[23]*b[23]
   -a[24]*b[24]-a[25]*b[25]
   -a[26]*b[26]+a[31]*b[31])
 
 res[2] =(a[2] *b[1] +a[1] *b[2] # e0
   +a[7] *b[3] -a[3] *b[7]
   +a[8] *b[4] -a[4] *b[8]
   +a[9] *b[5] -a[5] *b[9]
   +a[10]*b[6] -a[6] *b[10]
   -a[17]*b[11]-a[11]*b[17]
   -a[18]*b[12]-a[12]*b[18]
   -a[19]*b[13]-a[13]*b[19]
   -a[20]*b[14]-a[14]*b[20]
   -a[21]*b[15]-a[15]*b[21]
   -a[22]*b[16]-a[16]*b[22]
   -a[27]*b[23]+a[23]*b[27]
   -a[28]*b[24]+a[24]*b[28]
   -a[29]*b[25]+a[25]*b[29]
   -a[30]*b[26]+a[26]*b[30]
   +a[32]*b[31]+a[31]*b[32])
 
 res[3] =(a[3] *b[1] +a[1] *b[3] # e1
   +a[11]*b[4] -a[4] *b[11]
   +a[12]*b[5] -a[5] *b[12]
   +a[13]*b[6] -a[6] *b[13]
   -a[23]*b[14]-a[14]*b[23]
   -a[24]*b[15]-a[15]*b[24]
   -a[25]*b[16]-a[16]*b[25]
   -a[31]*b[26]+a[26]*b[31])
 res[4] =(a[4] *b[1] +a[1] *b[4] # e2
   -a[11]*b[3] +a[3] *b[11]
   +a[14]*b[5] -a[5] *b[14]
   +a[15]*b[6] -a[6] *b[15]
   +a[23]*b[12]+a[12]*b[23]
   +a[24]*b[13]+a[13]*b[24]
   -a[26]*b[16]-a[16]*b[26]
   +a[31]*b[25]-a[25]*b[31])
 res[5] =(a[5] *b[1] +a[1] *b[5] # e3
   -a[12]*b[3] +a[3] *b[12]
   -a[14]*b[4] +a[4] *b[14]
   +a[16]*b[6] -a[6] *b[16]
   -a[23]*b[11]-a[11]*b[23]
   +a[25]*b[13]+a[13]*b[25]
   +a[26]*b[15]+a[15]*b[26]
   -a[31]*b[24]+a[24]*b[31])
 res[6] =(a[6] *b[1] +a[1] *b[6] # e4
   -a[13]*b[3] +a[3] *b[13]
   -a[15]*b[4] +a[4] *b[15]
   -a[16]*b[5] +a[5] *b[16]
   -a[24]*b[11]-a[11]*b[24]
   -a[25]*b[12]-a[12]*b[25]
   -a[26]*b[14]-a[14]*b[26]
   +a[31]*b[23]-a[23]*b[31])
 res[7] =(a[7] *b[1] +a[1] *b[7] # e01
   +a[17]*b[4] +a[4] *b[17]
   +a[18]*b[5] +a[5] *b[18]
   +a[19]*b[6] +a[6] *b[19]
   -a[27]*b[14]-a[14]*b[27]
   -a[28]*b[15]-a[15]*b[28]
   -a[29]*b[16]-a[16]*b[29]
   -a[32]*b[26]-a[26]*b[32])
 res[8] =(a[8] *b[1] +a[1] *b[8] # e02
   -a[17]*b[3] -a[3] *b[17]
   +a[20]*b[5] +a[5] *b[20]
   +a[21]*b[6] +a[6] *b[21]
   +a[27]*b[12]+a[12]*b[27]
   +a[28]*b[13]+a[13]*b[28]
   -a[30]*b[16]-a[16]*b[30]
   +a[32]*b[25]+a[25]*b[32])
 res[9] =(a[9] *b[1] +a[1] *b[9] # e03
   -a[18]*b[3] -a[3] *b[18]
   -a[20]*b[4] -a[4] *b[20]
   +a[22]*b[6] +a[6] *b[22]
   -a[27]*b[11]-a[11]*b[27]
   +a[29]*b[13]+a[13]*b[29]
   +a[30]*b[15]+a[15]*b[30]
   -a[32]*b[24]-a[24]*b[32])
 res[10]=(a[10]*b[1] +a[1] *b[10] # e04
   -a[19]*b[3] -a[3] *b[19]
   -a[21]*b[4] -a[4] *b[21]
   -a[22]*b[5] -a[5] *b[22]
   -a[28]*b[11]-a[11]*b[28]
   -a[29]*b[12]-a[12]*b[29]
   -a[30]*b[14]-a[14]*b[30]
   +a[32]*b[23]+a[23]*b[32])
   
 res[11]=(a[11]*b[1] +a[1] *b[11] # e12
   +a[23]*b[5] +a[5] *b[23]
   +a[24]*b[6] +a[6] *b[24]
   -a[31]*b[16]-a[16]*b[31])
 res[12]=(a[12]*b[1] +a[1] *b[12] # e13
   -a[23]*b[4] -a[4] *b[23]
   +a[25]*b[6] +a[6] *b[25]
   +a[31]*b[15]+a[15]*b[31])
 res[13]=(a[13]*b[1] +a[1] *b[13] # e14
   -a[24]*b[4] -a[4] *b[24]
   -a[25]*b[5] -a[5] *b[25]
   -a[31]*b[14]-a[14]*b[31])
 res[14]=(a[14]*b[1] +a[1] *b[14] # e23
   +a[23]*b[3] +a[3] *b[23]
   +a[26]*b[6] +a[6] *b[26]
   -a[31]*b[13]-a[13]*b[31])
 res[15]=(a[15]*b[1] +a[1] *b[15] # e24
   +a[24]*b[3] +a[3] *b[24]
   -a[26]*b[5] -a[5] *b[26]
   +a[31]*b[12]+a[12]*b[31])
 res[16]=(a[16]*b[1] +a[1] *b[16] # e34
   +a[25]*b[3] +a[3] *b[25]
   +a[26]*b[4] +a[4] *b[26]
   -a[31]*b[11]-a[11]*b[31])
 res[17]=(a[17]*b[1] +a[1] *b[17] # e012
   +a[27]*b[5] -a[5] *b[27]
   +a[28]*b[6] -a[6] *b[28]
   -a[32]*b[16]-a[16]*b[32])
 res[18]=(a[18]*b[1] +a[1] *b[18] # e013
   -a[27]*b[4] +a[4] *b[27]
   +a[29]*b[6] -a[6] *b[29]
   +a[32]*b[15]+a[15]*b[32])
 res[19]=(a[19]*b[1] +a[1] *b[19] # e014
   -a[28]*b[4] +a[4] *b[28]
   -a[29]*b[5] +a[5] *b[29]
   -a[32]*b[14]-a[14]*b[32])
 res[20]=(a[20]*b[1] +a[1] *b[20] # e023
   +a[27]*b[3] -a[3] *b[27]
   +a[30]*b[6] -a[6] *b[30]
   -a[32]*b[13]-a[13]*b[32])
 res[21]=(a[21]*b[1] +a[1] *b[21] # e024
   +a[28]*b[3] -a[3] *b[28]
   -a[30]*b[5] +a[5] *b[30]
   +a[32]*b[12]+a[12]*b[32])
 res[22]=(a[22]*b[1] +a[1] *b[22] # e034
   +a[29]*b[3] -a[3] *b[29]
   +a[30]*b[4] -a[4] *b[30]
   -a[32]*b[11]-a[11]*b[32])
 
 res[23]=(a[23]*b[1] +a[1] *b[23] # e123
   +a[31]*b[6] -a[6] *b[31])
 res[24]=(a[24]*b[1] +a[1] *b[24] # e124
   -a[31]*b[5] +a[5] *b[31])
 res[25]=(a[25]*b[1] +a[1] *b[25] # e134
   +a[31]*b[4] -a[4] *b[31])
 res[26]=(a[26]*b[1] +a[1] *b[26] # e234
   -a[31]*b[3] +a[3] *b[31])
 res[27]=(a[27]*b[1] +a[1] *b[27] # e0123
   +a[32]*b[6] +a[6] *b[32])
 res[28]=(a[28]*b[1] +a[1] *b[28] # e0124
   -a[32]*b[5] -a[5] *b[32])
 res[29]=(a[29]*b[1] +a[1] *b[29] # e0134
   +a[32]*b[4] +a[4] *b[32])
 res[30]=(a[30]*b[1] +a[1] *b[30] # e0234
   -a[32]*b[3] -a[3] *b[32])

 res[31] =a[31]*b[1] +a[1] *b[31] # e1234
 res[32] =a[32]*b[1] +a[1] *b[32] # e01234
 return res
end # inner product (|)
 
# outer product; wedge operator (^)
function Base.:^(a::Vector{Float32},b::Vector{Float32})::Vector{Float32}
 res = similar(a)
 
 res[1]= a[1]*b[1] # 1
 
 res[2]= a[2]*b[1] +a[1]*b[2] # e0
 res[3]= a[3]*b[1] +a[1]*b[3] # e1
 res[4]= a[4]*b[1] +a[1]*b[4] # e2
 res[5]= a[5]*b[1] +a[1]*b[5] # e3
 res[6]= a[6]*b[1] +a[1]*b[6] # e4
 
 res[7]= (a[7] *b[1] +a[1]*b[7] # e01
   -a[3] *b[2] +a[2]*b[3])
 res[8]= (a[8] *b[1] +a[1]*b[8] # e02
   -a[4] *b[2] +a[2]*b[4])
 res[9]= (a[9] *b[1] +a[1]*b[9] # e03
   -a[5] *b[2] +a[2]*b[5])
 res[10]=(a[10]*b[1] +a[1]*b[10] # e04
   -a[6] *b[2] +a[2]*b[6])
 res[11]=(a[11]*b[1] +a[1]*b[11] # e12
   -a[4] *b[3] +a[3]*b[4])
 res[12]=(a[12]*b[1] +a[1]*b[12] # e13
   -a[5] *b[3] +a[3]*b[5])
 res[13]=(a[13]*b[1] +a[1]*b[13] # e14
   -a[6] *b[3] +a[3]*b[6])
 res[14]=(a[14]*b[1] +a[1]*b[14] # e23
   -a[5] *b[4] +a[4]*b[5])
 res[15]=(a[15]*b[1] +a[1]*b[15] # e24
   -a[6] *b[4] +a[4]*b[6])
 res[16]=(a[16]*b[1] +a[1]*b[16] # e34
   -a[6] *b[5] +a[5]*b[6])
 
 res[17]=(a[17]*b[1] +a[1]*b[17] # e012
   +a[11]*b[2] +a[2]*b[11]
   -a[8] *b[3] -a[3]*b[8]
   +a[7] *b[4] +a[4]*b[7])
 res[18]=(a[18]*b[1] +a[1]*b[18] # e013
   +a[12]*b[2] +a[2]*b[12]
   -a[9] *b[3] -a[3]*b[9]
   +a[7] *b[5] +a[5]*b[7])
 res[19]=(a[19]*b[1] +a[1]*b[19] # e014
   +a[13]*b[2] +a[2]*b[13]
   -a[10]*b[3] -a[3]*b[10]
   +a[7] *b[6] +a[6]*b[7])
 res[20]=(a[20]*b[1] +a[1]*b[20] # e023
   +a[14]*b[2] +a[2]*b[14]
   -a[9] *b[4] -a[4]*b[9]
   +a[8] *b[5] +a[5]*b[8])
 res[21]=(a[21]*b[1] +a[1]*b[21] # e024
   +a[15]*b[2] +a[2]*b[15]
   -a[10]*b[4] -a[4]*b[10]
   +a[8] *b[6] +a[6]*b[8])
 res[22]=(a[22]*b[1] +a[1]*b[22] # e034
   +a[16]*b[2] +a[2]*b[16]
   -a[10]*b[5] -a[5]*b[10]
   +a[9] *b[6] +a[6]*b[9])
 res[23]=(a[23]*b[1] +a[1]*b[23] # e123
   +a[14]*b[3] +a[3]*b[14]
   -a[12]*b[4] -a[4]*b[12]
   +a[11]*b[5] +a[5]*b[11])
 res[24]=(a[24]*b[1] +a[1]*b[24] # e124
   +a[15]*b[3] +a[3]*b[15]
   -a[13]*b[4] -a[4]*b[13]
   +a[11]*b[6] +a[6]*b[11])
 res[25]=(a[25]*b[1] +a[1]*b[25] # e134
   +a[16]*b[3] +a[3]*b[16]
   -a[13]*b[5] -a[5]*b[13]
   +a[12]*b[6] +a[6]*b[12])
 res[26]=(a[26]*b[1] +a[1]*b[26] # e234
   +a[16]*b[4] +a[4]*b[16]
   -a[15]*b[5] -a[5]*b[15]
   +a[14]*b[6] +a[6]*b[14])
 
 res[27]=(a[27]*b[1] +a[1]*b[27] # e0123
   -a[23]*b[2] +a[2]*b[23]
   +a[20]*b[3] -a[3]*b[20]
   -a[18]*b[4] +a[4]*b[18]
   +a[17]*b[5] -a[5]*b[17]
   +a[14]*b[7] +a[7]*b[14]
   -a[12]*b[8] -a[8]*b[12]
   +a[11]*b[9] +a[9]*b[11])
 res[28]=(a[28]*b[1] +a[1] *b[28] # e0124
   -a[24]*b[2] +a[2] *b[24]
   +a[21]*b[3] -a[3] *b[21]
   -a[19]*b[4] +a[4] *b[19]
   +a[17]*b[6] -a[6] *b[17]
   +a[15]*b[7] +a[7] *b[15]
   -a[13]*b[8] -a[8] *b[13]
   +a[11]*b[10]+a[10]*b[11])
 res[29]=(a[29]*b[1] +a[1] *b[29] # e0134
   -a[25]*b[2] +a[2] *b[25]
   +a[22]*b[3] -a[3] *b[22]
   -a[19]*b[5] +a[5] *b[19]
   +a[18]*b[6] -a[6] *b[18]
   +a[16]*b[7] +a[7] *b[16]
   -a[13]*b[9] -a[9] *b[13]
   +a[12]*b[10]+a[10]*b[12])
 res[30]=(a[30]*b[1] +a[1] *b[30] # e0234
   -a[26]*b[2] +a[2] *b[26]
   +a[22]*b[4] -a[4] *b[22]
   -a[21]*b[5] +a[5] *b[21]
   +a[20]*b[6] -a[6] *b[20]
   +a[16]*b[8] +a[8] *b[16]
   -a[15]*b[9] -a[9] *b[15]
   +a[14]*b[10]+a[10]*b[14])
 res[31]=(a[31]*b[1] +a[1] *b[31] # e1234
   -a[26]*b[3] +a[3] *b[26]
   +a[25]*b[4] -a[4] *b[25]
   -a[24]*b[5] +a[5] *b[24]
   +a[23]*b[6] -a[6] *b[23]
   +a[16]*b[11]+a[11]*b[16]
   -a[15]*b[12]-a[12]*b[15]
   +a[14]*b[13]+a[13]*b[14])
 
 res[32]=(a[32]*b[1] +a[1] *b[32] # e01234
   +a[31]*b[2] +a[2] *b[31]
   -a[30]*b[3] -a[3] *b[30]
   +a[29]*b[4] +a[4] *b[29]
   -a[28]*b[5] -a[5] *b[28]
   +a[27]*b[6] +a[6] *b[27]
   +a[26]*b[7] +a[7] *b[26]
   -a[25]*b[8] -a[8] *b[25]
   +a[24]*b[9] +a[9] *b[24]
   -a[23]*b[10]-a[10]*b[23]
   +a[22]*b[11]+a[11]*b[22]
   -a[21]*b[12]-a[12]*b[21]
   +a[20]*b[13]+a[13]*b[20]
   +a[19]*b[14]+a[14]*b[19]
   -a[18]*b[15]-a[15]*b[18]
   +a[17]*b[16]+a[16]*b[17])
 return res
end # outer product; wedge operator (^)

# reverse operator (~)
function Base.:~(a::Vector{Float32})
 res = copy(a)
 res[7:26] .*= -1
 return res
end # reverse operator

# conjugate
function conjugate(a::Vector{Float32})::Vector{Float32}
 res = copy(a)
 res[2:16] .*= -1
 res[32] *= -1
 return res
end # conjugate()

# unit test
# arguments:
# - nLoop repeats a section of the PGA calculations for benchmarking
# usage notes:
# - @time utest(1) checks on whether the unit test output of ripga.jl
# exactly matches the unit test output of pga3d.cpp. The comparison
# ends with the printing of the number of tests in the unit test that
# don't match. 0 indicates success.
# - @time utest(1,true) outputs a slightly simplified version of the 
# unit test output that does not match the unit test output by pga3d.cpp.
# - @btime utest() is a test for execution speed of ripga.jl.
#   (NOTE: requires using BenchmarkTools)
function utest(nLoop=100, flgSimplify::Bool=false)
 nField = length(basis)
 P0 = Vector{Float32}(undef,nField)
 P1 = Vector{Float32}(undef,nField)
 P2 = Vector{Float32}(undef,nField)
 P3 = Vector{Float32}(undef,nField)
 line0 = Vector{Float32}(undef,nField)
 line1 = Vector{Float32}(undef,nField)
 x = Vector{Float32}(undef,nField)
 tst1 = Vector{Float32}(undef,nField)
 tst2 = Vector{Float32}(undef,nField)

 for iLoop = 1:nLoop
  # define some points
  P0 = point(0,0,0,0)
  P1 = point(1,0,0,0)
  P2 = point(0,1,0,0)
  P3 = point(1,1,0,0)
  
  # calculate intersection of parallel lines
  line0 = P0 & P1
  line1 = P2 & P3
  x = line0 ^ line1
  
  tst1 = e0 - 1f0
  tst2 = 1f0 - e0
 
#  # geometric algebra equations in math syntax
#  ga"axis_z = e1 ∧ e2"
#  ga"origin = axis_z ∧ e3"
#  
#  px = point(1f0, 0f0, 0f0)
#  ga"line = origin ∨ px"
#  p = plane(2f0,0f0,1f0,-3f0)
#  ga"rot = rotor(Float32(pi/2), e1 e2)"
#  ga"rot_point = rot px ~rot"
#  ga"rot_line = rot line ~rot"
#  ga"rot_plane = rot p ~rot"
#  
#  tst1 = e0 - 1f0
#  tst2 = 1f0 - e0
 end

 # if (slow) output of unit test results wanted
 if nLoop == 1
  nError = 0

  S = Matrix{String}(undef,9,3)  # 3 columns:
  S[1,1] = " P0             : "  # 1) label
  S[1,2] = toStr(P0)             # 2) toStr()
  S[1,3] = "e1234"               # 3) expected string
  
  S[2,1] = " P1             : "
  S[2,2] = toStr(P1)
  S[2,3] = "e0234 + e1234"
  
  S[3,1] = " P2             : "
  S[3,2] = toStr(P2)
  S[3,3] = "e0134 + e1234"
  
  S[4,1] = " P3             : "
  S[4,2] = toStr(P3)
  S[4,3] = "e0134 + e0234 + e1234"
  
  S[5,1] = " line0          : "
  S[5,2] = toStr(line0)
  S[5,3] = "-e234"
  
  S[6,1] = " line1          : "
  S[6,2] = toStr(line1)
  S[6,3] = "e034 - e234"
  
  S[7,1] = " intersection   : "
  S[7,2] = toStr(x)
  S[7,3] = "-e20"
  
  S[8,1] = " toStr test 1   : "
  S[8,2] = toStr(tst1)
  S[8,3] = "-1 + e0"
  
  S[9,1] = " toStr test 2   : "
  S[9,2] = toStr(tst2)
  S[9,3] = "1 - e0"
  
  # print unit test results;
  nTest = size(S,1)
  for iTest = 1:nTest
   if S[iTest,2] == S[iTest,3]
    mark = " "
   else
    mark = "x"
    nError += 1
   end
   println("$mark" * S[iTest,1] * S[iTest,2])
  end

  return nError # return unit test results
 end
end # ripga4d utest()